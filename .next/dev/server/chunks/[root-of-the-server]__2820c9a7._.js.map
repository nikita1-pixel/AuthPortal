{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/nirma/OneDrive/Desktop/PROJECTS/coffee-store/src/app/api/auth/%5B...nextauth%5D/route.ts"],"sourcesContent":["import NextAuth from \"next-auth\";\r\nimport CredentialsProvider from \"next-auth/providers/credentials\";\r\n\r\nconst handler = NextAuth({\r\n  providers: [\r\n    CredentialsProvider({\r\n      name: \"Credentials\",\r\n      credentials: {\r\n        email: { label: \"Email\", type: \"text\" },\r\n        password: { label: \"Password\", type: \"password\" }\r\n      },\r\n      async authorize(credentials) {\r\n        // 1. Debugging: Log exactly what is arriving\r\n        console.log(\"--- Login Attempt Received ---\");\r\n        console.log(\"Email from user:\", credentials?.email);\r\n\r\n        const enteredEmail = credentials?.email?.toLowerCase().trim();\r\n        const developerEmail = \"nikkitachoudhary306@gmail.com\".toLowerCase().trim();\r\n\r\n        // 2. Load and clean Environment emails\r\n        const envEmails = process.env.ADMIN_EMAILS || \"\";\r\n        const adminEmails = envEmails.split(',').map(e => e.trim().toLowerCase());\r\n\r\n        const isDeveloper = enteredEmail === developerEmail;\r\n        const isInEnvList = adminEmails.includes(enteredEmail || \"\");\r\n\r\n        // 3. Validation Logic\r\n        if (isDeveloper || isInEnvList) {\r\n          console.log(\"AUTH STATUS: Success (User verified)\");\r\n          return {\r\n            id: \"admin-master\",\r\n            name: \"Nikkita\",\r\n            email: enteredEmail,\r\n            isAdmin: true\r\n          };\r\n        }\r\n\r\n        console.log(\"AUTH STATUS: Failed - Access Denied for\", enteredEmail);\r\n        return null;\r\n      }\r\n    })\r\n  ],\r\n  callbacks: {\r\n    async jwt({ token, user }) {\r\n      if (user) {\r\n        token.isAdmin = (user as any).isAdmin;\r\n      }\r\n      return token;\r\n    },\r\n    async session({ session, token }) {\r\n      if (session.user) {\r\n        (session.user as any).isAdmin = token.isAdmin;\r\n      }\r\n      return session;\r\n    }\r\n  },\r\n  pages: {\r\n    signIn: \"/login\",\r\n    error: \"/login\", // Redirect back to login on error\r\n  },\r\n  session: {\r\n    strategy: \"jwt\",\r\n    maxAge: 30 * 24 * 60 * 60, // 30 days\r\n  },\r\n  // If your .env.local isn't loading, we provide a fallback secret here for testing\r\n  secret: process.env.NEXTAUTH_SECRET || \"fallback_secret_for_dev_only\",\r\n});\r\n\r\nexport { handler as GET, handler as POST };"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEA,MAAM,UAAU,IAAA,wMAAQ,EAAC;IACvB,WAAW;QACT,IAAA,2NAAmB,EAAC;YAClB,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAO;gBACtC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,6CAA6C;gBAC7C,QAAQ,GAAG,CAAC;gBACZ,QAAQ,GAAG,CAAC,oBAAoB,aAAa;gBAE7C,MAAM,eAAe,aAAa,OAAO,cAAc;gBACvD,MAAM,iBAAiB,gCAAgC,WAAW,GAAG,IAAI;gBAEzE,uCAAuC;gBACvC,MAAM,YAAY,QAAQ,GAAG,CAAC,YAAY,IAAI;gBAC9C,MAAM,cAAc,UAAU,KAAK,CAAC,KAAK,GAAG,CAAC,CAAA,IAAK,EAAE,IAAI,GAAG,WAAW;gBAEtE,MAAM,cAAc,iBAAiB;gBACrC,MAAM,cAAc,YAAY,QAAQ,CAAC,gBAAgB;gBAEzD,sBAAsB;gBACtB,IAAI,eAAe,aAAa;oBAC9B,QAAQ,GAAG,CAAC;oBACZ,OAAO;wBACL,IAAI;wBACJ,MAAM;wBACN,OAAO;wBACP,SAAS;oBACX;gBACF;gBAEA,QAAQ,GAAG,CAAC,2CAA2C;gBACvD,OAAO;YACT;QACF;KACD;IACD,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,IAAI,MAAM;gBACR,MAAM,OAAO,GAAG,AAAC,KAAa,OAAO;YACvC;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,IAAI,QAAQ,IAAI,EAAE;gBACf,QAAQ,IAAI,CAAS,OAAO,GAAG,MAAM,OAAO;YAC/C;YACA,OAAO;QACT;IACF;IACA,OAAO;QACL,QAAQ;QACR,OAAO;IACT;IACA,SAAS;QACP,UAAU;QACV,QAAQ,KAAK,KAAK,KAAK;IACzB;IACA,kFAAkF;IAClF,QAAQ,QAAQ,GAAG,CAAC,eAAe,IAAI;AACzC"}}]
}